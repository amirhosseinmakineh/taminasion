<div class="business-details-page">
  <div class="state" *ngIf="isLoading">
    ุฏุฑ ุญุงู ุจุงุฑฺฏุฐุงุฑ ุงุทูุงุนุงุช...
  </div>

  <div class="state error" *ngIf="!isLoading && errorMessage">
    {{ errorMessage }}
  </div>

  <ng-container *ngIf="!isLoading && !errorMessage && businessDetail as detail">
    <div class="cover">
      <img [src]="getBannerUrl(detail.bannerName)" [alt]="'ฺฉุงูุฑ ' + detail.name" />
      <div class="logo-box">
        <ng-container *ngIf="getLogoUrl(detail.logo) as logoUrl; else logoInitial">
          <img [src]="logoUrl" [alt]="detail.name" />
        </ng-container>
        <ng-template #logoInitial>
          <span>{{ getInitial(detail.name) }}</span>
        </ng-template>
      </div>
    </div>

    <div class="container">
      <div class="card">
        <div class="info-header">
          <div>
            <h1>{{ detail.name }}</h1>
            <p class="person-count">
              {{ detail.cityName }}ุ {{ detail.regionName }}ุ {{ detail.neighberhoodName }}
            </p>
          </div>
          <div class="rating" *ngIf="averageRating !== null || ratingCount > 0">
            <span class="star">โ</span>
            <span class="score">{{ averageRating !== null ? (averageRating | number:'1.1-1') : 'ุจุฏูู ุงูุชุงุฒ' }}</span>
            <span class="votes">({{ ratingCount | number:'1.0-0' }})</span>
          </div>
        </div>

        <div class="tabs" role="tablist">
          <button type="button" [class.active]="activeTab === 'about'" (click)="setActiveTab('about')">
            ุฏุฑุจุงุฑู ูุง
          </button>
          <button type="button" [class.active]="activeTab === 'staff'" (click)="setActiveTab('staff')">
            ูพุฑุณูู
          </button>
          <button type="button" [class.active]="activeTab === 'info'" (click)="setActiveTab('info')">
            ุงุทูุงุนุงุช ุณุงูู
          </button>
          <button type="button" [class.active]="activeTab === 'reviews'" (click)="setActiveTab('reviews')">
            ูุธุฑุงุช
          </button>
        </div>

        <div class="tab-content" [class.active]="activeTab === 'about'">
          <div>
            <p *ngIf="detail.description; else noDescription">
              {{ detail.description }}
            </p>
            <ng-template #noDescription>
              <p>ุชูุถุญ ุจุฑุง ุงู ุณุงูู ุซุจุช ูุดุฏู ุงุณุช.</p>
            </ng-template>
          </div>
          <div class="achievements" *ngIf="detail.achievementDtos?.length; else noAchievements">
            <h3>ุฏุณุชุงูุฑุฏูุง</h3>
            <div class="tags">
              <span
                class="tag"
                [ngClass]="getAchievementColor(i)"
                *ngFor="let achievement of detail.achievementDtos; index as i; trackBy: trackByAchievement"
              >
                {{ achievement.name }}
              </span>
            </div>
          </div>
          <ng-template #noAchievements>
            <div class="achievements empty">
              <h3>ุฏุณุชุงูุฑุฏูุง</h3>
              <p>ุฏุณุชุงูุฑุฏ ุจุฑุง ุงู ุณุงูู ุซุจุช ูุดุฏู ุงุณุช.</p>
            </div>
          </ng-template>
        </div>

        <div class="tab-content" [class.active]="activeTab === 'staff'">
          <div>
            <p>
              ุจุฑูุงููโูุง ูุนุงู ุงู ุณุงูู ุฏุฑ {{ detail.businessOwnerDayDtos.length | number:'1.0-0' }} ุฑูุฒ ููุชู ุซุจุช ุดุฏู ุงุณุช.
            </p>
            <p *ngIf="detail.businessOwnerDayDtos.length === 0">
              ูููุฒ ุจุฑูุงููโุง ุจุฑุง ุงู ุณุงูู ุซุจุช ูุดุฏู ุงุณุช.
            </p>
          </div>
          <div class="services" *ngIf="detail.businessServiceDtos?.length">
            <h3>ุฎุฏูุงุช ุงุฑุงุฆู ุดุฏู</h3>
            <ul>
              <li *ngFor="let service of detail.businessServiceDtos; trackBy: trackByService">
                <span>{{ service.serviceName }}</span>
                <span>{{ formatCurrency(service.amount) }}</span>
              </li>
            </ul>
          </div>
        </div>

        <div class="tab-content" [class.active]="activeTab === 'info'">
          <div>
            <p>๐ ุขุฏุฑุณ: {{ detail.cityName }}ุ {{ detail.regionName }}ุ {{ detail.neighberhoodName }}</p>
            <p *ngIf="hasWorkingHours(detail.businessOwnerDayDtos); else noSchedule">
              ๐ ุณุงุนุช ฺฉุงุฑ:
            </p>
            <ul class="schedule" *ngIf="hasWorkingHours(detail.businessOwnerDayDtos)">
              <li *ngFor="let day of detail.businessOwnerDayDtos; trackBy: trackByDay">
                <span>{{ getDayName(day.dayOfWeek) }}</span>
                <span>{{ getWorkingHours(day) }}</span>
              </li>
            </ul>
            <ng-template #noSchedule>
              <p>๐ ุณุงุนุช ฺฉุงุฑ ุซุจุช ูุดุฏู ุงุณุช.</p>
            </ng-template>
          </div>
        </div>

        <div class="tab-content" [class.active]="activeTab === 'reviews'">
          <div *ngIf="detail.commentDtos?.length; else noComments">
            <div class="review" *ngFor="let comment of detail.commentDtos; trackBy: trackByComment">
              <p class="review-author">{{ comment.userFullName || 'ูุดุชุฑ' }}</p>
              <p class="review-text">{{ getCommentText(comment) }}</p>
            </div>
          </div>
          <ng-template #noComments>
            <p>ูููุฒ ูุธุฑ ุจุฑุง ุงู ุณุงูู ุซุจุช ูุดุฏู ุงุณุช.</p>
          </ng-template>
        </div>
      </div>
    </div>
  </ng-container>
</div>
